# Trivy ignore file
# This file is used to suppress Trivy findings that are false positives or known acceptable risks.

# Suppress ConfigMap secrets for Argocd, as Argocd manages its own secrets.
# AVD-KSV-0109: ConfigMap secrets
# The argocd-cm and argocd-notifications-cm are not meant to store sensitive credentials.
# Trivy is too aggressive here.
AVD-KSV-0109: deployments/argocd/base/argocd-install.yaml
AVD-KSV-0109: deployments/argocd/gcp-production-app.yaml

# Suppress ConfigMap secrets for mcp-server-langgraph-config.
# dynamic_context_max_tokens and model_max_tokens are configuration, not secrets.
AVD-KSV-0109: deployments/base/configmap.yaml

# Suppress readOnlyRootFilesystem findings for overlays/patches
# AVD-KSV-0014: Container should set 'securityContext.readOnlyRootFilesystem' to true
#
# Note: Base deployments (deployments/base/*) all have readOnlyRootFilesystem: true
# with appropriate volume mounts (tmpfs/emptyDir for writable paths, persistent volumes for data).
#
# The following suppressions are for Kustomize overlay patches which may override
# base settings. Most patches don't change readOnlyRootFilesystem, so these suppressions
# prevent false positives when Trivy scans patch files in isolation.

# Keycloak staging-gke: Requires readOnlyRootFilesystem: false for Quarkus JIT compilation
# See deployments/overlays/staging-gke/.trivyignore for comprehensive security justification
AVD-KSV-0014: deployments/overlays/staging-gke/keycloak-patch.yaml

# Existing patch ignores
AVD-KSV-0014: deployments/overlays/production-gke/deployment-patch.yaml
AVD-KSV-0014: deployments/overlays/production-gke/keycloak-patch.yaml
AVD-KSV-0014: deployments/overlays/production-gke/openfga-patch.yaml
AVD-KSV-0014: deployments/overlays/production/deployment-patch.yaml
AVD-KSV-0014: deployments/overlays/production/otel-collector-patch.yaml
AVD-KSV-0014: deployments/overlays/production/postgres-patch.yaml
AVD-KSV-0014: deployments/overlays/production/qdrant-patch.yaml
AVD-KSV-0014: deployments/overlays/production/redis-session-patch.yaml
AVD-KSV-0014: deployments/overlays/staging-gke/keycloak-patch.yaml
AVD-KSV-0014: deployments/overlays/staging-gke/otel-collector-patch.yaml
AVD-KSV-0014: deployments/overlays/staging/deployment-patch.yaml
AVD-KSV-0014: deployments/overlays/staging/otel-collector-patch.yaml
AVD-KSV-0014: deployments/kubernetes/kong/kong-jwks-updater-cronjob.yaml
AVD-KSV-0014: deployments/kubernetes/kong/redis-deployment.yaml
AVD-KSV-0014: deployments/optimized/postgres-statefulset.yaml
AVD-KSV-0014: deployments/overlays/dev/deployment-patch.yaml
AVD-KSV-0014: deployments/overlays/dev/otel-collector-patch.yaml
AVD-KSV-0014: deployments/overlays/dev/postgres-patch.yaml
AVD-KSV-0014: deployments/overlays/dev/qdrant-patch.yaml
AVD-KSV-0014: deployments/overlays/dev/redis-session-patch.yaml
AVD-KSV-0014: deployments/kubernetes/overlays/aws/deployment-patch.yaml

# External IP/Name for Memorystore (Intentional)
AVD-KSV-0108: deployments/overlays/staging-gke/redis-session-service-patch.yaml
