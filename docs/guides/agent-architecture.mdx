---
title: Agent Architecture and Usage
description: LangGraph agent architecture with Pydantic AI integration for production-ready intelligent agents
icon: 'brain'
contentType: explanation
seoTitle: LangGraph Agent Architecture - Production AI Agents Guide
seoDescription: Comprehensive guide to LangGraph agent architecture with Pydantic AI integration. Learn stateful conversation management, tool integration, and production best practices.
keywords:
  - langgraph
  - agent architecture
  - pydantic ai
  - stateful agents
  - tool integration
  - llm agents
  - conversation management
---

# Agent Architecture and Usage

This document describes the agent architecture used in MCP Server LangGraph and provides guidance for working with LangGraph agents and Pydantic AI integration.

**Related Documentation**: This guide covers agent architecture. For Claude Code workflow guidance, see [CLAUDE.md](https://github.com/vishnu2kmohan/mcp-server-langgraph/blob/main/.github/CLAUDE.md).

## Table of Contents

- [Overview](#overview)
- [LangGraph Agent](#langgraph-agent)
- [Pydantic AI Integration](#pydantic-ai-integration)
- [Agent Configuration](#agent-configuration)
- [Tool Integration](#tool-integration)
- [State Management](#state-management)
- [Best Practices](#best-practices)

## Overview

MCP Server LangGraph implements a **functional agent architecture** using LangGraph for stateful conversation management and Pydantic AI for structured outputs and tool calling.

**Note**: This guide is placed at the repository root for maximum discoverability. For project-specific Claude Code workflow patterns, see [CLAUDE.md](https://github.com/vishnu2kmohan/mcp-server-langgraph/blob/main/.github/CLAUDE.md).

### Architecture Diagram

```mermaid
flowchart TD
    subgraph MCP["MCP Server Layer"]
        STDIO["stdio Transport"]
        HTTP["StreamableHTTP Transport"]
    end

    subgraph Auth["Auth Middleware"]
        JWT["JWT + OpenFGA"]
    end

    subgraph Agent["LangGraph Agent"]
        Graph["Agent Graph<br/>(StateGraph)"]
        Routing["Conditional Routing"]
        Tools["Tool Execution"]
        Graph --> Routing --> Tools
    end

    subgraph Pydantic["Pydantic AI Integration"]
        Structured["Structured Output"]
        ToolDef["Tool Definition"]
        Model["Model Abstraction"]
    end

    LLM["LLM Factory<br/>(LiteLLM + Fallback)"]

    STDIO --> JWT
    HTTP --> JWT
    JWT --> Graph
    Tools --> Structured
    Structured --> ToolDef
    ToolDef --> Model
    Model --> LLM

    %% ColorBrewer2 Set3 palette - each component type uniquely colored
    classDef mcpStyle fill:#8dd3c7,stroke:#2a9d8f,stroke-width:2px,color:#333
    classDef authStyle fill:#bebada,stroke:#7e5eb0,stroke-width:2px,color:#333
    classDef agentStyle fill:#b3de69,stroke:#7cb342,stroke-width:2px,color:#333
    classDef pydanticStyle fill:#fdb462,stroke:#e67e22,stroke-width:2px,color:#333
    classDef llmStyle fill:#fb8072,stroke:#e74c3c,stroke-width:2px,color:#333

    class STDIO,HTTP mcpStyle
    class JWT authStyle
    class Graph,Routing,Tools agentStyle
    class Structured,ToolDef,Model pydanticStyle
    class LLM llmStyle
```

[... rest of AGENTS.md content continues as in the original ...]

---

**Last Updated**: 2025-10-14
**LangGraph Version**: 0.6.10 (upgraded from 0.2.28)
**Pydantic AI Version**: 0.0.15
