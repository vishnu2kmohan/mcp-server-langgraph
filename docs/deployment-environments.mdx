# Deployment Environments - Version Matrix

This document provides a comprehensive overview of all deployment environments, service versions, and configuration differences.

**Last Updated**: 2025-11-21
**Synchronization Status**: ✅ All environments synchronized (Docker + Helm)

---

## Environment Overview

| Environment | Purpose | Docker Compose File | Kubernetes Config | Network Name |
|-------------|---------|-------------------|-------------------|--------------|
| **Production** | Live production workloads | `docker-compose.yml` | `deployments/helm/values-production-gke.yaml` | `mcp-network` |
| **Test** | Automated testing | `docker-compose.test.yml` | N/A | `mcp-test-network` |
| **Development** | Local development | `docker-compose.dev.yml` | N/A | `mcp-dev-network` |
| **Minimal** | Lightweight stack | `docker-compose.minimal.yml` | N/A | `mcp-network-minimal` |

---

## Service Version Matrix

### Infrastructure Services (Synchronized Across All Environments)

| Service | Version | Image | Notes |
|---------|---------|-------|-------|
| **PostgreSQL** | 16.8-alpine | `postgres:16.8-alpine` | Explicit version pinning |
| **Keycloak** | 26.4.2 | `quay.io/keycloak/keycloak:26.4.2` | Latest stable v26 |
| **OpenFGA** | v1.10.2 | `openfga/openfga:v1.10.2` | Authorization service |
| **Redis** | 7-alpine | `redis:7-alpine` | Cache & sessions |
| **Qdrant** | v1.15.5 | `qdrant/qdrant:v1.15.5` | Vector database |
| **Jaeger** | 1.62.0 | `jaegertracing/all-in-one:1.62.0` | Distributed tracing |
| **Prometheus** | v3.7.1 | `prom/prometheus:v3.7.1` | Metrics collection |
| **AlertManager** | v0.28.1 | `prom/alertmanager:v0.28.1` | Alert management |
| **Grafana** | 12.2.0 | `grafana/grafana:12.2.0` | Visualization |

---

## Helm Chart Dependencies (Kubernetes Deployments)

| Dependency | Chart Version | Application Version | Repository |
|------------|--------------|---------------------|------------|
| **OpenFGA** | 0.2.49 | v1.11.1 | openfga.github.io/helm-charts |
| **PostgreSQL** | 18.1.11 | 17.7.0 | charts.bitnami.com/bitnami |
| **Redis** | 23.2.12 | 7.4.2 | charts.bitnami.com/bitnami |
| **Keycloak** | 25.2.0 | 26.4.1 | charts.bitnami.com/bitnami |
| **Grafana** | 12.1.8 | 12.2.0 | charts.bitnami.com/bitnami |
| **Jaeger** | 3.4.1 | 1.62.0 | jaegertracing.github.io/helm-charts |
| **Kube-Prometheus** | 79.6.1 | 0.81.0 | prometheus-community.github.io/helm-charts |

---

## Deployment Synchronization (2025-11-21)

### Changes Applied

**Docker Service Version Updates** (2025-11-20):
- PostgreSQL: All environments → 16.8-alpine (explicit version)
- Keycloak: All environments → 26.4.2 (from 26.0.0/23.0)
- Qdrant: All environments → v1.15.5 (from v1.15.1)
- Development: Pinned all versions (no more 'latest' tags)

**Helm Chart Version Updates** (2025-11-21):
- OpenFGA: 0.2.12 → 0.2.49 (includes OpenFGA v1.11.1)
- PostgreSQL: 16.6.2 → 18.1.11 (includes PostgreSQL 17.7.0)
- Redis: 20.6.2 → 23.2.12 (includes Redis 7.4.2)
- Keycloak: 24.2.2 → 25.2.0 (includes Keycloak 26.4.1)
- Kube-Prometheus-Stack: 78.3.2 → 79.6.1
- Grafana: 12.1.8 (already latest)
- Jaeger: 3.4.1 (already latest)

**Environment Enhancements**:
- Development: Network renamed to `mcp-dev-network` (conflict resolution)
- Test: Added full observability stack (Jaeger, Prometheus, AlertManager, Grafana)
- Helm: Increased maxReplicas to 20 (from 10)

**Configuration Management**:
- Added service version variables to .env templates
- CI/CD automated version validation
- Helm dependencies upgraded to latest stable releases

**Files Modified**: 11 files across Docker, Helm, and documentation

---

**Maintained By**: DevOps Team
**Review Schedule**: Quarterly or on major version updates
