# =============================================================================
# Trivy Security Scan Suppressions - GKE Staging Overlay
# =============================================================================
#
# This file contains documented suppressions for false positive Trivy findings.
#
# IMPORTANT: Only suppress findings that are verified false positives.
# All suppressions must be documented with clear justification.
#
# Review periodically to ensure suppressions are still valid.
#
# =============================================================================

# -----------------------------------------------------------------------------
# AVD-KSV-0109: ConfigMap False Positive - LLM Token Configuration Values
# -----------------------------------------------------------------------------
#
# Finding: ConfigMap 'staging-mcp-server-langgraph-config' stores secrets in
#          key(s) '{"dynamic_context_max_tokens", "model_max_tokens"}'
#
# Why This is a False Positive:
#   - model_max_tokens: Numeric value for maximum LLM context size (e.g., 128000)
#   - dynamic_context_max_tokens: Numeric value for dynamic context limit (e.g., 8000)
#
# These are PUBLIC configuration values, NOT authentication tokens:
#   - They control LLM behavior (max tokens in request/response)
#   - Analogous to database connection pool size or timeout values
#   - No security risk from exposure (publicly documented in LLM provider docs)
#   - Safe to store in ConfigMap
#
# Why Trivy Flags This:
#   Trivy's heuristic flags any key/value containing substring "token" as
#   potentially sensitive, which is overly broad for this use case.
#
# Verification:
#   - Reviewed configmap-patch.yaml lines 76-77, 99-100
#   - Confirmed values are numeric configuration, not auth credentials
#   - No sensitive data present
#
# Date: 2025-11-10
# Reviewed by: Claude Code (automated TDD validation)
#
AVD-KSV-0109

# -----------------------------------------------------------------------------
# End of Suppressions
# -----------------------------------------------------------------------------
#
# If you add new suppressions:
# 1. Document WHY the finding is a false positive
# 2. Reference specific files and line numbers
# 3. Add verification notes
# 4. Include date and reviewer
# 5. Update tests/meta/test_trivy_suppressions.py to validate
#
