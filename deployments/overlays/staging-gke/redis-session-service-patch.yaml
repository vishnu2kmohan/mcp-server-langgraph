---
# Transform redis-session service to headless service for Memorystore Redis
#
# Replaces the base ClusterIP service (which points to in-cluster redis-session
# deployment) with a headless service that uses manual Endpoints to point to
# the external Memorystore Redis instance at 10.138.129.37:6378.
#
# Headless services (clusterIP: None) with manual Endpoints are the correct
# approach for exposing external IP addresses. ExternalName services require
# DNS names, not IP addresses.
apiVersion: v1
kind: Service
metadata:
  name: redis-session
  annotations:
    description: "Headless service for Memorystore Redis at 10.138.129.37:6378"
spec:
  type: ClusterIP
  clusterIP: None  # Headless service - uses manual Endpoints
  selector: null   # No selector - endpoints are manually defined
  ports:
  - name: memorystore-redis
    port: 6378          # Memorystore Redis port (not default 6379)
    protocol: TCP
    targetPort: 6378
