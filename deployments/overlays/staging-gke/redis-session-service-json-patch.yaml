# Replace self-hosted Redis service with ExternalName to Memorystore Redis
# JSON 6902 patch to transform ClusterIP service to ExternalName service

# Replace type to ExternalName
- op: replace
  path: /spec/type
  value: ExternalName

# Add externalName
- op: add
  path: /spec/externalName
  value: "10.138.129.37"

# Replace ports array completely (Memorystore uses port 6378, not 6379)
- op: replace
  path: /spec/ports
  value:
    - name: redis
      port: 6378
      protocol: TCP
      targetPort: 6378

# Replace selector with empty to remove it
- op: replace
  path: /spec/selector
  value: {}

# Add description annotation
- op: add
  path: /metadata/annotations/description
  value: "ExternalName service pointing to Memorystore Redis at 10.138.129.37:6378"
