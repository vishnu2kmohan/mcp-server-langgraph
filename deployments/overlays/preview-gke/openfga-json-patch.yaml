# Set OpenFGA ServiceAccount for Workload Identity
# Note: Overlay resources don't get namePrefix applied, so we use the exact overlay SA name
- op: replace
  path: /spec/template/spec/serviceAccountName
  value: openfga-sa

# Fix secret reference to use preview-prefixed secret name
- op: replace
  path: /spec/template/spec/containers/0/env/1/valueFrom/secretKeyRef/name
  value: preview-mcp-server-langgraph-secrets

# Remove init container - OpenFGA will wait for DB internally
- op: remove
  path: /spec/template/spec/initContainers/0
