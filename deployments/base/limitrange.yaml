---
# LimitRange for mcp-server-langgraph namespace
# Provides default resource constraints for pods and containers
apiVersion: v1
kind: LimitRange
metadata:
  name: default-limits
  namespace: mcp-server-langgraph
spec:
  limits:
    # Container-level limits
    # Updated 2025-12-04: Aligned with GKE Autopilot LimitRange requirements
    - type: Container
      # Default limits (applied if not specified)
      default:
        cpu: 500m
        memory: 512Mi
        ephemeral-storage: 500Mi
      # Default requests (applied if not specified)
      defaultRequest:
        cpu: 250m
        memory: 256Mi
        ephemeral-storage: 200Mi
      # Minimum allowed (GKE Autopilot requires 128Mi memory, 100Mi ephemeral-storage)
      min:
        cpu: 100m
        memory: 128Mi
        ephemeral-storage: 100Mi
      # Maximum allowed
      max:
        cpu: 4000m
        memory: 8Gi
        ephemeral-storage: 10Gi
      # Maximum ratio between limit and request (prevents unrealistic ratios)
      maxLimitRequestRatio:
        cpu: 4
        memory: 4

    # Pod-level limits
    - type: Pod
      # Maximum resources for a single pod
      max:
        cpu: 8000m
        memory: 16Gi
        ephemeral-storage: 20Gi
      # Minimum resources for a single pod (GKE Autopilot requirements)
      min:
        cpu: 100m
        memory: 128Mi
        ephemeral-storage: 100Mi

    # PersistentVolumeClaim limits
    - type: PersistentVolumeClaim
      # Minimum PVC size
      min:
        storage: 1Gi
      # Maximum PVC size
      max:
        storage: 100Gi
