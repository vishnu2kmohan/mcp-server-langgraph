Running end-to-end tests (parallel execution, requires test infrastructure)...
Ensuring test infrastructure is running...
make test-infra-up
make[1]: Entering directory '/home/vishnu/git/vishnu2kmohan/worktrees/mcp-server-langgraph-session-20251118-221044'
Starting test infrastructure (docker-compose.test.yml)...
docker compose -f docker-compose.test.yml up -d
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-jaeger-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-qdrant-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-prometheus-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-keycloak-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-redis-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-openfga-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-redis-sessions-test-1  Running
 Container mcp-server-langgraph-session-20251118-221044-grafana-test-1  Recreate
 Container mcp-server-langgraph-session-20251118-221044-grafana-test-1  Recreated
 Container mcp-server-langgraph-session-20251118-221044-prometheus-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-alertmanager-test-1  Starting
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-alertmanager-test-1  Started
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-prometheus-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-openfga-migrate-test-1  Starting
 Container mcp-server-langgraph-session-20251118-221044-grafana-test-1  Starting
 Container mcp-server-langgraph-session-20251118-221044-openfga-migrate-test-1  Started
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-openfga-migrate-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-grafana-test-1  Started
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-openfga-migrate-test-1  Exited
 Container mcp-server-langgraph-session-20251118-221044-qdrant-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-keycloak-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-openfga-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-redis-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-redis-sessions-test-1  Waiting
 Container mcp-server-langgraph-session-20251118-221044-qdrant-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-redis-sessions-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-redis-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-openfga-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-keycloak-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-postgres-test-1  Healthy
 Container mcp-server-langgraph-session-20251118-221044-mcp-server-test-1  Starting
 Container mcp-server-langgraph-session-20251118-221044-mcp-server-test-1  Started
âœ“ Test infrastructure started

Test Services (offset ports by 1000):
  PostgreSQL: localhost:9432
  Redis:      localhost:9379
  OpenFGA:    http://localhost:9080
  Keycloak:   http://localhost:9082
  Qdrant:     http://localhost:9333

make[1]: Leaving directory '/home/vishnu/git/vishnu2kmohan/worktrees/mcp-server-langgraph-session-20251118-221044'

Waiting for services to be healthy...
[0;34mâ„¹[0m Using: docker compose
[0;34mâ„¹[0m Compose file: docker-compose.test.yml
[0;34mâ„¹[0m No specific services specified - waiting for all services with healthchecks
[0;34mâ„¹[0m Waiting for 12 service(s): jaeger-test postgres-test keycloak-test openfga-migrate-test openfga-test prometheus-test alertmanager-test grafana-test redis-test qdrant-test redis-sessions-test mcp-server-test

[0;34mâ„¹[0m Waiting for [0;33mjaeger-test[0m to become healthy...
[0;34mâ„¹[0m jaeger-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (20s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (30s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (40s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (50s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (60s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (70s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (80s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (90s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (100s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (110s / 120s)...
[0;34mâ„¹[0m jaeger-test not yet healthy (120s / 120s)...
[0;31mâœ—[0m jaeger-test failed to become healthy within 120s
[0;34mâ„¹[0m Last 20 lines of jaeger-test logs:
jaeger-test-1  | 2025/11/22 22:22:34 maxprocs: Updating GOMAXPROCS=1: using minimum allowed GOMAXPROCS
jaeger-test-1  | 2025/11/22 22:22:34 application version: git-commit=4b7446248e087edffd15508e760e8e5da044f4b4, git-version=v1.62.0, build-date=2024-10-07T09:16:33Z
jaeger-test-1  | {"level":"warn","ts":1763850154.1394212,"caller":"static/provider.go:71","msg":"Default operations level strategies will not be included for Ratelimiting service strategies.This behavior will be changed in future releases. Cf. https://github.com/jaegertracing/jaeger/issues/5270"}
jaeger-test-1  | {"level":"warn","ts":1763850154.1441312,"caller":"internal@v0.111.0/warning.go:40","msg":"Using the 0.0.0.0 address exposes this server to every network interface, which may facilitate Denial of Service attacks.","documentation":"https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks"}
jaeger-test-1  | {"level":"warn","ts":1763850154.1442049,"caller":"internal@v0.111.0/warning.go:40","msg":"Using the 0.0.0.0 address exposes this server to every network interface, which may facilitate Denial of Service attacks.","documentation":"https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks"}
[0;34mâ„¹[0m Waiting for [0;33mpostgres-test[0m to become healthy...
[0;34mâ„¹[0m postgres-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (20s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (30s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (40s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (50s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (60s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (70s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (80s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (90s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (100s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (110s / 120s)...
[0;34mâ„¹[0m postgres-test not yet healthy (120s / 120s)...
[0;31mâœ—[0m postgres-test failed to become healthy within 120s
[0;34mâ„¹[0m Last 20 lines of postgres-test logs:
postgres-test-1  | 2025-11-22 22:23:20.648 UTC [211] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:23:35.649 UTC [248] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:23:50.648 UTC [286] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:24:05.648 UTC [323] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:24:20.648 UTC [360] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:24:35.648 UTC [397] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:24:50.648 UTC [435] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:25:05.648 UTC [465] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:25:20.649 UTC [501] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:25:35.648 UTC [538] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:25:50.648 UTC [576] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:26:05.648 UTC [613] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:26:20.648 UTC [650] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:26:35.648 UTC [687] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:26:50.648 UTC [725] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:27:05.648 UTC [762] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:27:20.649 UTC [799] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:27:35.327 UTC [91] LOG:  checkpoint starting: time
postgres-test-1  | 2025-11-22 22:27:35.649 UTC [835] LOG:  invalid length of startup packet
postgres-test-1  | 2025-11-22 22:27:50.648 UTC [873] LOG:  invalid length of startup packet
[0;34mâ„¹[0m Waiting for [0;33mkeycloak-test[0m to become healthy...
[0;34mâ„¹[0m keycloak-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (20s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (30s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (40s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (50s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (60s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (70s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (80s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (90s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (100s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (110s / 120s)...
[0;34mâ„¹[0m keycloak-test not yet healthy (120s / 120s)...
[0;31mâœ—[0m keycloak-test failed to become healthy within 120s
[0;34mâ„¹[0m Last 20 lines of keycloak-test logs:
keycloak-test-1  | WARNING: Hostname v1 options [hostname-strict-https] are still in use, please review your configuration
keycloak-test-1  | Updating the configuration and installing your custom providers, if any. Please wait.
keycloak-test-1  | WARNING: Hostname v1 options [hostname-strict-https] are still in use, please review your configuration
keycloak-test-1  | Running the server in development mode. DO NOT use this configuration in production.
keycloak-test-1  | 2025-11-22 22:22:56,280 WARN  [org.keycloak.services] (main) KC-SERVICES0110: Environment variable 'KEYCLOAK_ADMIN' is deprecated, use 'KC_BOOTSTRAP_ADMIN_USERNAME' instead
keycloak-test-1  | 2025-11-22 22:22:56,280 WARN  [org.keycloak.services] (main) KC-SERVICES0110: Environment variable 'KEYCLOAK_ADMIN_PASSWORD' is deprecated, use 'KC_BOOTSTRAP_ADMIN_PASSWORD' instead
[0;34mâ„¹[0m Waiting for [0;33mopenfga-migrate-test[0m to become healthy...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (20s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (30s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (40s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (50s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (60s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (70s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (80s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (90s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (100s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (110s / 120s)...
[0;34mâ„¹[0m openfga-migrate-test not yet healthy (120s / 120s)...
[0;31mâœ—[0m openfga-migrate-test failed to become healthy within 120s
[0;34mâ„¹[0m Last 20 lines of openfga-migrate-test logs:
openfga-migrate-test-1  | 2025-11-22T22:10:26.155Z	[34mINFO[0m	db info	{"current version": 0}
openfga-migrate-test-1  | 2025-11-22T22:10:26.155Z	[34mINFO[0m	running all migrations
openfga-migrate-test-1  | 2025-11-22T22:10:26.176Z	[34mINFO[0m	migration done
openfga-migrate-test-1  | 2025-11-22T22:17:12.039Z	[34mINFO[0m	db info	{"current version": 6}
openfga-migrate-test-1  | 2025-11-22T22:17:12.039Z	[34mINFO[0m	running all migrations
openfga-migrate-test-1  | 2025-11-22T22:17:12.039Z	[34mINFO[0m	migration done
openfga-migrate-test-1  | 2025-11-22T22:22:37.800Z	[34mINFO[0m	db info	{"current version": 0}
openfga-migrate-test-1  | 2025-11-22T22:22:37.800Z	[34mINFO[0m	running all migrations
openfga-migrate-test-1  | 2025-11-22T22:22:37.819Z	[34mINFO[0m	migration done
openfga-migrate-test-1  | 2025-11-22T22:23:42.234Z	[34mINFO[0m	db info	{"current version": 6}
openfga-migrate-test-1  | 2025-11-22T22:23:42.234Z	[34mINFO[0m	running all migrations
openfga-migrate-test-1  | 2025-11-22T22:23:42.235Z	[34mINFO[0m	migration done
[0;34mâ„¹[0m Waiting for [0;33mopenfga-test[0m to become healthy...
[0;34mâ„¹[0m openfga-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (20s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (30s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (40s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (50s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (60s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (70s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (80s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (90s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (100s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (110s / 120s)...
[0;34mâ„¹[0m openfga-test not yet healthy (120s / 120s)...
[0;31mâœ—[0m openfga-test failed to become healthy within 120s
[0;34mâ„¹[0m Last 20 lines of openfga-test logs:
openfga-test-1  | {"level":"warn","timestamp":1763850158.4242568,"msg":"authentication is disabled","build.version":"v1.10.2","build.commit":"2a454e3772389af0e06f5472eb2d898c264cc732"}
openfga-test-1  | {"level":"warn","timestamp":1763850158.4243011,"msg":"gRPC TLS is disabled, serving connections using insecure plaintext","build.version":"v1.10.2","build.commit":"2a454e3772389af0e06f5472eb2d898c264cc732"}
openfga-test-1  | {"level":"warn","timestamp":1763850158.4251935,"msg":"HTTP TLS is disabled, serving connections using insecure plaintext","build.version":"v1.10.2","build.commit":"2a454e3772389af0e06f5472eb2d898c264cc732"}
[0;34mâ„¹[0m Waiting for [0;33mprometheus-test[0m to become healthy...
[0;34mâ„¹[0m prometheus-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (20s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (30s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (40s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (50s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (60s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (70s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (80s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (90s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (100s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (110s / 120s)...
[0;34mâ„¹[0m prometheus-test not yet healthy (120s / 120s)...
[0;31mâœ—[0m prometheus-test failed to become healthy within 120s
[0;34mâ„¹[0m Last 20 lines of prometheus-test logs:
[0;34mâ„¹[0m Waiting for [0;33malertmanager-test[0m to become healthy...
[0;34mâ„¹[0m alertmanager-test not yet healthy (10s / 120s)...
[0;34mâ„¹[0m alertmanager-test not yet healthy (20s / 120s)...
